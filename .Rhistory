install.packages("knn")
salesRFM$Kc=kmeans(salesRFM$Value)
salesRFM$Kc <- kmeans(salesRFM$Value,8)
Kc <- kmeans(salesRFM$Value,8)
str(Kc)
salesRFM$Kc <- kmeans(salesRFM$Value,8)$cluster
View(salesRFM)
CategoryInfo <- aggregate(salesRFM$Value,list(salesRFM$Category),mean)
salesRFM$Value=salesRFM$Monetization*0.221+salesRFM$Frequency*0.341+salesRFM$Recency*0.439
salesRFM$Category<- kmeans(salesRFM$Value,8)$cluster
CategoryInfo <- aggregate(salesRFM$Value,list(salesRFM$Category),mean)
View(CategoryInfo)
CategoryInfo$Mean <- aggregate(salesRFM$Value,list(salesRFM$Category),mean)
ValueMean=mean(CategoryInfo$Mean)
ValueMean=mean(CategoryInfo$Mean,trim=.2)
ValueMean=mean(CategoryInfo$Mean,trim=2)
ValueMean=apply(CategoryInfo$Mean,2,mean)
str(ValueMean)
ValueMean=apply(CategoryInfo$Mean,mean)
ValueMean=apply(CategoryInfo,1,mean)
ValueMean=apply(CategoryInfo$Mean,1,mean)
View(CategoryInfo)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization)
salesRFM$Frequency=scale(salesRFM$Frequency)
salesRFM$Recency=scale(salesRFM$Recency)
salesRFM$Value=salesRFM$Monetization*0.221+salesRFM$Frequency*0.341+salesRFM$Recency*0.439
salesRFM$Category = kmeans(salesRFM$Value,8)$cluster
CategoryInfo$Mean = aggregate(salesRFM$Value,list(salesRFM$Category),mean)
CategoryInfo = aggregate(salesRFM$Value,list(salesRFM$Category),mean)
ValueMean=apply(CategoryInfo$Mean,1,mean)
View(CategoryInfo)
ValueMean=apply(CategoryInfo,1,mean)
ValueMean=apply(CategoryInfo,2,mean)
ValueMean=apply(CategoryInfo,1,mean)
ValueMean=apply(CategoryInfo[,1],2,mean)
ValueMean=mean(CategoryInfo)
ValueMean=mean(CategoryInfo)
ValueMean=apply(CategoryInfo,2,mean)
ValueMean=apply(CategoryInfo[,1],2,mean)
ValueMean=apply(CategoryInfo[,0],2,mean)
ValueMean=apply(CategoryInfo[,2],2,mean)
View(CategoryInfo)
ValueMean=apply(CategoryInfo$V1,2,mean)
ValueMean=colMeans(CategoryInfo$V1)
ValueMean=colMeans(CategoryInfo)
names(CategoryInfo)<-c("CategoryID", "Mean")
ValueMean=colMeans(CategoryInfo$Mean)
ValueMean=mean(CategoryInfo$Mean)
CategoryInfo$Trend <- CategoryInfo$Mean>valueMean
CategoryInfo$Trend <- CategoryInfo$Mean>ValueMean
View(CategoryInfo)
View(CategoryInfo)
View(salesRFM)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Value=salesRFM$Monetization*0.221+salesRFM$Frequency*0.341+salesRFM$Recency*0.439
salesRFM$Category = kmeans(salesRFM$Value,8)$cluster
CategoryInfo = aggregate(salesRFM$Value,list(salesRFM$Category),mean)
names(CategoryInfo)<-c("CategoryID", "Mean")
ValueMean=mean(CategoryInfo$Mean)
CategoryInfo$Trend <- CategoryInfo$Mean>ValueMean
View(CategoryInfo)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Category = kmeans(salesRFM,8)$cluster
View(salesRFM)
salesRFM$Category = kmeans(salesRFM[,2:4],8)$cluster
View(salesRFM)
CategoryInfo$MMean = aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
CategoryInfo$Frequency = aggregate(salesRFM$Frequency,list(salesRFM$Category),mean)
CategoryInfo = aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
CategoryInfo$Frequency = aggregate(salesRFM$Frequency,list(salesRFM$Category),mean)
Category <- vector()
CategoryInfo = aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
CategoryInfo$Frequency = aggregate(salesRFM$Frequency,list(salesRFM$Category),mean)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Category = kmeans(salesRFM[,2:4],8)$cluster
CategoryInfo <- vector()
CategoryInfo = aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
CategoryInfo$Frequency = aggregate(salesRFM$Frequency,list(salesRFM$Category),mean)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Category = kmeans(salesRFM[,2:4],8)$cluster
CategoryInfo <- vector()
CategoryInfo$Monetization = aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
View(salesRFM)
CategoryInfo$Frequency = aggregate(salesRFM$Frequency,list(salesRFM$Category),mean)
CategoryInfo <- data.frame()
CategoryInfo$Monetization = aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
CategoryInfo$Monetization <- aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
CategoryInfo <- data.frame()
CategoryInfo$Monetization <- aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
help
help data.frame()
help data.frame
help data
CategoryInfo <- data.frame(3,8)
View(CategoryInfo)
CategoryInfo <- data.frame([3:8])
CategoryInfo <- data.frame(1ï¼š8)
CategoryInfo <- data.frame(ID=c([1:8]))
CategoryInfo <- data.frame(ID=c(1:8))
View(CategoryInfo)
CategoryInfo <- data.frame(ID=c(1:8))
CategoryInfo$Monetization <- aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
CategoryInfo$Frequency = aggregate(salesRFM$Frequency,list(salesRFM$Category),mean)
View(CategoryInfo)
CategoryInfo[,2] <- aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
CategoryInfo <- aggregate(salesRFM$Monetization,list(salesRFM$Category),mean)
View(CategoryInfo)
CategoryInfo$Frequency = aggregate(salesRFM$Frequency,list(salesRFM$Category),mean)
View(CategoryInfo)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Value=salesRFM$Monetization*0.221+salesRFM$Frequency*0.341+salesRFM$Recency*0.439
salesRFM$Category = kmeans(salesRFM$Value,8)$cluster
CategoryInfo = aggregate(salesRFM$Value,list(salesRFM$Category),mean)
names(CategoryInfo)<-c("CategoryID", "Mean")
ValueMean=mean(CategoryInfo$Mean)
CategoryInfo$Trend <- CategoryInfo$Mean>ValueMean
View(CategoryInfo)
CategoryInfo <- aggregate(salesRFM[,2:4],list(salesRFM$Category),mean)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Category = kmeans(salesRFM[,2:4],8)$cluster
CategoryInfo <- aggregate(salesRFM[,2:4],list(salesRFM$Category),mean)
View(CategoryInfo)
MonetizationMean=mean(CategoryInfo$MonetizationMean)
names(CategoryInfo)<-c("CategoryInfoID", "MonetizationMean", "FrequencyMean","RecencyMean")
MonetizationMean=mean(CategoryInfo$MonetizationMean)
FrequencyMean=mean(CategoryInfo$FrequencyMean)
RecencyMean=mean(CategoryInfo$RecencyMean)
CategoryInfo$MonetizationComp=CategoryInfo$MonetizationMean>MonetizationMean
CategoryInfo$FrequencyMean=CategoryInfo$FrequencyMean>FrequencyMean
CategoryInfo$RecencyMean=CategoryInfo$RecencyMean>RecencyMean
View(CategoryInfo)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Category = kmeans(salesRFM[,2:4],8)$cluster
CategoryInfo <- aggregate(salesRFM[,2:4],list(salesRFM$Category),mean)
names(CategoryInfo)<-c("CategoryInfoID", "MonetizationMean", "FrequencyMean","RecencyMean")
MonetizationMean=mean(CategoryInfo$MonetizationMean)
FrequencyMean=mean(CategoryInfo$FrequencyMean)
RecencyMean=mean(CategoryInfo$RecencyMean)
CategoryInfo$MonetizationComp=CategoryInfo$MonetizationMean>MonetizationMean
CategoryInfo$FrequencyMean=CategoryInfo$FrequencyMean>FrequencyMean
CategoryInfo$RecencyMean=CategoryInfo$RecencyMean>RecencyMean
View(CategoryInfo)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Category = kmeans(salesRFM[,2:4],8)$cluster
CategoryInfo <- aggregate(salesRFM[,2:4],list(salesRFM$Category),mean)
View(CategoryInfo)
names(CategoryInfo)<-c("CategoryInfoID", "MonetizationMean", "FrequencyMean","RecencyMean")
View(CategoryInfo)
MonetizationMean=mean(CategoryInfo$MonetizationMean)
FrequencyMean=mean(CategoryInfo$FrequencyMean)
RecencyMean=mean(CategoryInfo$RecencyMean)
CategoryInfo$MonetizationComp=CategoryInfo$MonetizationMean>MonetizationMean
CategoryInfo$FrequencyComp=CategoryInfo$FrequencyMean>FrequencyMean
CategoryInfo$RecencyComp=CategoryInfo$RecencyMean>RecencyMean
View(CategoryInfo)
CategoryInfo$Rank=order(CategoryInfo$ValueMean,T)
View(CategoryInfo)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Value=salesRFM$Monetization*0.221+salesRFM$Frequency*0.341+salesRFM$Recency*0.439
salesRFM$Category = kmeans(salesRFM$Value,8)$cluster
CategoryInfo <- aggregate(salesRFM[,2:5],list(salesRFM$Category),mean)
names(CategoryInfo)<-c("CategoryInfoID", "MonetizationMean", "FrequencyMean","RecencyMean","ValueMean")
MonetizationMean=mean(CategoryInfo$MonetizationMean)
FrequencyMean=mean(CategoryInfo$FrequencyMean)
RecencyMean=mean(CategoryInfo$RecencyMean)
ValueMean=mean(CategoryInfo$ValueMean)
CategoryInfo$MonetizationComp=CategoryInfo$MonetizationMean>MonetizationMean
CategoryInfo$FrequencyComp=CategoryInfo$FrequencyMean>FrequencyMean
CategoryInfo$RecencyComp=CategoryInfo$RecencyMean>RecencyMean
CategoryInfo$ValueComp=CategoryInfo$ValueMean>ValueMean
CategoryInfo$Rank=order(CategoryInfo$ValueMean,T)
CategoryInfo$Rank=order(CategoryInfo$ValueMean)
View(CategoryInfo)
CategoryInfo=sort(CategoryInfo$ValueMean)
View(salesRFM)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Value=salesRFM$Monetization*0.221+salesRFM$Frequency*0.341+salesRFM$Recency*0.439
salesRFM$Category = kmeans(salesRFM$Value,8)$cluster
CategoryInfo <- aggregate(salesRFM[,2:5],list(salesRFM$Category),mean)
names(CategoryInfo)<-c("CategoryInfoID", "MonetizationMean", "FrequencyMean","RecencyMean","ValueMean")
MonetizationMean=mean(CategoryInfo$MonetizationMean)
FrequencyMean=mean(CategoryInfo$FrequencyMean)
RecencyMean=mean(CategoryInfo$RecencyMean)
ValueMean=mean(CategoryInfo$ValueMean)
CategoryInfo$MonetizationComp=CategoryInfo$MonetizationMean>MonetizationMean
CategoryInfo$FrequencyComp=CategoryInfo$FrequencyMean>FrequencyMean
CategoryInfo$RecencyComp=CategoryInfo$RecencyMean>RecencyMean
CategoryInfo$ValueComp=CategoryInfo$ValueMean>ValueMean
CategoryInfo=sort(CategoryInfo$ValueMean)
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
salesRFM$Value=salesRFM$Monetization*0.221+salesRFM$Frequency*0.341+salesRFM$Recency*0.439
salesRFM$Category = kmeans(salesRFM$Value,8)$cluster
CategoryInfo <- aggregate(salesRFM[,2:5],list(salesRFM$Category),mean)
names(CategoryInfo)<-c("CategoryInfoID", "MonetizationMean", "FrequencyMean","RecencyMean","ValueMean")
MonetizationMean=mean(CategoryInfo$MonetizationMean)
FrequencyMean=mean(CategoryInfo$FrequencyMean)
RecencyMean=mean(CategoryInfo$RecencyMean)
ValueMean=mean(CategoryInfo$ValueMean)
CategoryInfo$MonetizationComp=CategoryInfo$MonetizationMean>MonetizationMean
CategoryInfo$FrequencyComp=CategoryInfo$FrequencyMean>FrequencyMean
CategoryInfo$RecencyComp=CategoryInfo$RecencyMean>RecencyMean
CategoryInfo$ValueComp=CategoryInfo$ValueMean>ValueMean
CategoryInfo=CategoryInfo[order(CategoryInfo$ValueMean),]
View(CategoryInfo)
CategoryInfo=CategoryInfo[order(CategoryInfo$ValueMean,decreasing=T),]
View(CategoryInfo)
library(magrittr)
install.packages("magrittr")
install.packages("dplyr")
install.packages("readxl")
install.packages("fpc")
install.packages("lattive")
install.packages("lattice")
install.packages("MASS")
install.packages("nnet")
install.packages("mice")
sum(is.na(salesRFM))
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
library(lattice)
library(MASS)
library(nnet)
salesRFM <- read_excel("consumption_data.xls")
sum(is.na(salesRFM))
sum(complete.cases(salesRFM))
md.pattern(salesRFM)
install.packages("outliers")
library(outliers)
outlier(salesRFM)
plot(salesRFM)
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
bplot=boxplot(salesRFM$Monetization,boxwex=0.7)
bplot=boxplot(salesRFM$Frequency,boxwex=0.7)
bplot=boxplot(salesRFM$Recency,boxwex=0.7)
help("boxplot")
bplot=boxplot(salesRFM$Monetization,outline=FALSE,boxwex=0.7)
bplot=boxplot(salesRFM$Monetization,outline=FALSE,boxwex=0.7)
bplot=boxplot(salesRFM$Monetization,boxwex=0.7)
bplot=boxplot(salesRFM,boxwex=0.7)
help("boxplot")
bplot=boxplot(salesRFM$Monetization,outline=FALSE,boxwex=0.7)
bplot=boxplot(salesRFM$Frequency,boxwex=0.7)
bplot=boxplot(salesRFM$Recency,boxwex=0.7)
bplot=boxplot(salesRFM$Monetization,outline=FALSE,boxwex=0.7)
help("boxplot")
salesRFM <- salesRFM[!which(salesRFM$Monetization==bplot$out),]
salesRFM <- salesRFM[!which(salesRFM$Monetization %in% bplot$out),]
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
sum(is.na(salesRFM))
sum(complete.cases(salesRFM))
bplot=boxplot(salesRFM$Monetization,outline=FALSE,boxwex=0.7)
salesRFM <- salesRFM[which(salesRFM$Monetization %in% bplot$out),]
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
sum(is.na(salesRFM))
sum(complete.cases(salesRFM))
bplot=boxplot(salesRFM$Monetization,outline=FALSE,boxwex=0.7)
salesRFM <- salesRFM[-which(salesRFM$Monetization %in% bplot$out),]
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
sum(is.na(salesRFM))
sum(complete.cases(salesRFM))
bplot=boxplot(salesRFM$Monetization,boxwex=0.7)
salesRFM <- salesRFM[-which(salesRFM$Monetization %in% bplot$out),]
bplot=boxplot(salesRFM$Frequency,boxwex=0.7)
salesRFM <- salesRFM[-which(salesRFM$Frequency %in% bplot$out),]
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
sum(is.na(salesRFM))
sum(complete.cases(salesRFM))
bplot=boxplot(salesRFM$Monetization,boxwex=0.7)
salesRFM <- salesRFM[-which(salesRFM$Monetization %in% bplot$out),]
bplot=boxplot(salesRFM$Frequency,boxwex=0.7)
bplot=boxplot(salesRFM$Recency,boxwex=0.7)
salesRFM <- salesRFM[-which(salesRFM$Recency %in% bplot$out),]
bplot=boxplot(salesRFM$Frequency,boxwex=0.7)
salesRFM <- salesRFM[-which(salesRFM$Frequency %in% bplot$out),]
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Monetization %in% bplot$out),]
length(bplot$out)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
sum(is.na(salesRFM))
sum(complete.cases(salesRFM))
bplot=boxplot(salesRFM$Monetization,boxwex=0.7)
length(bplot$out)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
sum(is.na(salesRFM))
sum(complete.cases(salesRFM))
bplot=boxplot(salesRFM$Monetization,boxwex=0.7)
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Monetization %in% bplot$out),]
bplot=boxplot(salesRFM$Frequency,boxwex=0.7)
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Frequency %in% bplot$out),]
bplot=boxplot(salesRFM$Recency,boxwex=0.7)
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Recency %in% bplot$out),]
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
library(lattice)
library(MASS)
library(nnet)
library(outliers)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
sum(is.na(salesRFM))
sum(complete.cases(salesRFM))
bplot=boxplot(salesRFM$Monetization,boxwex=0.7)
bplot=boxplot(salesRFM$Monetization,boxwex=0.7)
if(length(bplot$out)>0)
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Monetization %in% bplot$out),]
bplot=boxplot(salesRFM$Frequency,boxwex=0.7)
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Frequency %in% bplot$out),]
bplot=boxplot(salesRFM$Recency,boxwex=0.7)
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Recency %in% bplot$out),]
install.packages("DMwR")
install.packages("DMwR")
install.packages("DMwR")
install.packages("dprep")
install.packages("dprep")
install.packages("dprep")
install.packages("DMwR")
kmeansAbnDetecion<-kmeans(salesRFM,centers=8);
kmeansAbnDetecion
kmeansAbnDetecion$centers
centers<-kmeansAbnDetecion$centers[kmeansAbnDetecion$cluster,]
centers
library(magrittr)
library(dplyr)
library(readxl)
library(fpc)
library(MASS)
library(lattice)
library(nnet)
library(outliers)
salesRFM <- read_excel("consumption_data.xls")
names(salesRFM)<-c("CustomerId", "Monetization", "Frequency","Recency")
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
sum(is.na(salesRFM))
sum(complete.cases(salesRFM))
bplot=boxplot(salesRFM$Monetization,boxwex=0.7)
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Monetization %in% bplot$out),]
bplot=boxplot(salesRFM$Frequency,boxwex=0.7)
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Frequency %in% bplot$out),]
bplot=boxplot(salesRFM$Recency,boxwex=0.7)
if(length(bplot$out)>0)
salesRFM <- salesRFM[-which(salesRFM$Recency %in% bplot$out),]
distances<-sqrt(rowSums((salesRFM-centers)^2))
kmeansAbnDetecion<-kmeans(salesRFM,centers=8)
centers<-kmeansAbnDetecion$centers[kmeansAbnDetecion$cluster,]
centers
distances<-sqrt(rowSums((salesRFM-centers)^2))
outliers<-order(distances,decreasing = T)[1:5]
plot(salesRFM,pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
kmeansAbnDetecion<-kmeans(salesRFM[,2:4],centers=8)
centers<-kmeansAbnDetecion$centers[kmeansAbnDetecion$cluster,]
centers
distances<-sqrt(rowSums((salesRFM-centers)^2))
outliers<-order(distances,decreasing = T)[1:5]
plot(salesRFM,pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
salesRFM$Monetization=scale(salesRFM$Monetization,F)
salesRFM$Frequency=scale(salesRFM$Frequency,F)
salesRFM$Recency=scale(salesRFM$Recency,F)
plot(salesRFM[,2:4],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
plot(salesRFM[outliers,2:4],pck="+",col=4,cex=1.5)
outliers<-order(distances,decreasing = T)[1:5]
plot(salesRFM[,2:4],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
plot(salesRFM[outliers,2:4],pck="+",col=4,cex=1.5)
outliers<-order(distances,decreasing = T)[1:5]
plot(salesRFM[,2:4],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
points(salesRFM[outliers,2:4],pck="+",col=4,cex=1.5)
points(salesRFM[outliers,2:4],pck="+",col=4,cex=5)
points(salesRFM[outliers,2:4],pch="+",col=4,cex=1.5)
points(salesRFM[outliers,2:4],pch="+",col=4,cex=1.5)
points(salesRFM[outliers,2:4],="+",col=4,cex=1.5)
points(salesRFM[outliers,2:4],pch="+",col=4,cex=1.5)
outliers<-order(distances,decreasing = T)[1:100]
plot(salesRFM[,2:4],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
points(salesRFM[outliers,2:4],pch="+",col=4,cex=1.5)
plot(salesRFM[,2:3],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
points(salesRFM[outliers,2:3],pch="+",col=4,cex=1.5)
outliers<-order(distances,decreasing = T)[1:20]
plot(salesRFM[,2:3],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
points(salesRFM[outliers,2:3],pch="+",col=4,cex=1.5)
outliers<-order(distances,decreasing = T)[1:10]
plot(salesRFM[,2:3],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
points(salesRFM[outliers,2:3],pch="+",col=4,cex=1.5)
help("points")
outliers<-order(distances,decreasing = T)[1:10]
plot(salesRFM[,2:3],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
points(salesRFM[outliers,2:3],pch="+",col=4,cex=1.5)
points(salesRFM[outliers,2:3],pch="+",col=4,cex=15)
points(salesRFM[outliers,2:3],pch="+",col=4,cex=1.5)
points(salesRFM[outliers,2:3],pch="+",col=4,cex=1.5)
plot(salesRFM[,2:3],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
points(salesRFM[outliers,2:3],pch="+",col=4,cex=1.5)
outliers<-order(distances,decreasing = T)[1:10]
plot(salesRFM[,2:4],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
points(salesRFM[outliers,2:4],pch="+",col=4,cex=1.5)
outliers
plot(salesRFM[,2:4],pch="o",col=kmeansAbnDetecion$cluster,cex=0.3)
outliers
points(salesRFM[outliers,2:4],pch="+",col=4,cex=15)
salesRFM <- salesRFM[-which(salesRFM$CustomerId %in% outliers),]
